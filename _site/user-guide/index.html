<!DOCTYPE html>
<html>

  <head>

  <!-- Viewing -->
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="website" property="og:type">


  <!-- Descriptions -->
  <meta name="description" content="OpenShift Developer Optimization
">
  <title>OpenShift Developer Optimization</title>


  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
  <link rel="manifest" href="/img/manifest.json">
  <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/img/favicon.ico">
  <meta name="msapplication-config" content="/img/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">


  <!-- HLJS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js">
  </script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>

</head>


  <!-- CSS -->
  <link href="/css/default.css" rel="stylesheet" type="text/css">
  <link href="/css/pilcrow.css" rel="stylesheet" type="text/css">

<body>

  <header>
    <a class="logo" href="/">
      <img class="parcel" src="/img/logo.png" height="30"alt="">
    </a>
    <div class="links">
      <a href="/quickstart">Documentation</a> <a href="https://github.com/redhat-developer/odo" target="_blank">GitHub</a>
    </div>
  </header>

  <div class="content">
    <nav>
      <h3>Documentation</h3>
      <ul>
        
          
            <li><a href="/quickstart/">Quick Start</a></li>
          
        
          
            <li><a href="/installation/">Installation</a></li>
          
        
          
            <li><a class="active" href="/user-guide/">User Guide</a></li>
          
        
      </ul>
      <h3>Advanced</h3>
      <ul>
        
          
            <li><a href="/development/">Development</a></li>
          
        
      </ul>
    </nav>


    <main>

    <h1 id="user-guide">User Guide</h1>

<ul id="markdown-toc">
  <li><a href="#user-guide" id="markdown-toc-user-guide">User Guide</a>    <ul>
      <li><a href="#kedge-apply" id="markdown-toc-kedge-apply">Kedge Apply</a></li>
      <li><a href="#kedge-create" id="markdown-toc-kedge-create">Kedge Create</a></li>
      <li><a href="#kedge-generate" id="markdown-toc-kedge-generate">Kedge Generate</a></li>
      <li><a href="#kedge-delete" id="markdown-toc-kedge-delete">Kedge Delete</a></li>
      <li><a href="#kedge-version" id="markdown-toc-kedge-version">Kedge Version</a></li>
      <li><a href="#kedge-init" id="markdown-toc-kedge-init">Kedge Init</a></li>
      <li><a href="#kedge-build" id="markdown-toc-kedge-build">Kedge Build</a>        <ul>
          <li><a href="#build-using-source-to-image" id="markdown-toc-build-using-source-to-image">Build using source to image</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="kedge-apply">Kedge Apply</h2>

<p>Deploy directly to Kubernetes, either updating or creating the artifacts if they don’t exist.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge apply <span class="nt">-f</span> httpd.yaml
deployment <span class="s2">"httpd"</span> created
service <span class="s2">"httpd"</span> created
</code></pre></div></div>

<h2 id="kedge-create">Kedge Create</h2>

<p>Deploy directly to Kubernetes without creating the artifacts. Internally, Kedge will generate the artifacts and then create it using the <code class="highlighter-rouge">kubectl</code> command.</p>

<p><strong>Deploy to Kubernetes:</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge create <span class="nt">-f</span> httpd.yaml
deployment <span class="s2">"httpd"</span> created
service <span class="s2">"httpd"</span> created
</code></pre></div></div>

<h2 id="kedge-generate">Kedge Generate</h2>

<p>Generate Kubernetes artifacts based upon your Kedge YAML file, see our <a href="/examples">examples</a> or the <a href="/docs/file-reference.md">file reference</a> on how to create said file.</p>

<p>In these examples, we use the <a href="/examples/simplest/httpd.yaml">simplest of examples</a></p>

<p><strong>Convert to Kubernetes artifacts:</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge generate <span class="nt">-f</span> httpd.yaml
<span class="nt">---</span>
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  creationTimestamp: null
  labels:
    app: httpd
  name: httpd
spec:
  strategy: <span class="o">{}</span>
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: httpd
      name: httpd
    spec:
      containers:
      - image: centos/httpd
        name: httpd
        resources: <span class="o">{}</span>
status: <span class="o">{}</span>
<span class="nt">---</span>
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: null
  labels:
    app: httpd
  name: httpd
spec:
  ports:
  - port: 8080
    targetPort: 80
  selector:
    app: httpd
  <span class="nb">type</span>: NodePort
status:
  loadBalancer: <span class="o">{}</span>
</code></pre></div></div>

<p><strong>Generate and deploy directly to Kubernetes:</strong></p>

<p>Generation commands can also be “piped” to Kubernetes</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge generate <span class="nt">-f</span> httpd.yaml | kubectl create <span class="nt">-f</span> -
deployment <span class="s2">"httpd"</span> created
service <span class="s2">"httpd"</span> created
</code></pre></div></div>

<h2 id="kedge-delete">Kedge Delete</h2>

<p>Deletes Kubernetes artifacts</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge delete <span class="nt">-f</span> httpd.yaml
deployment <span class="s2">"httpd"</span> deleted
service <span class="s2">"httpd"</span> deleted
</code></pre></div></div>
<h2 id="kedge-version">Kedge Version</h2>

<p>Outputs the current Kedge version</p>

<p><strong>Version:</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge version
</code></pre></div></div>

<h2 id="kedge-init">Kedge Init</h2>

<p><strong>Getting started:</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge init <span class="nt">--name</span> web <span class="nt">--image</span> centos/httpd <span class="nt">--ports</span> 80
</code></pre></div></div>
<p>This will create a <code class="highlighter-rouge">kedge.yml</code> file for an <code class="highlighter-rouge">httpd</code> web server with container
image <code class="highlighter-rouge">centos/httpd</code> exposed on port 80.</p>

<p><strong>Create a different file:</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge init <span class="nt">--out</span> myapp.yml <span class="nt">--name</span> web <span class="nt">--image</span> centos/httpd <span class="nt">--ports</span> 80
</code></pre></div></div>

<p>This will create a different file named <code class="highlighter-rouge">myapp.yml</code> as opposed to the default
<code class="highlighter-rouge">kedge.yml</code>.</p>

<p><strong>Create a different controller type:</strong></p>

<p>By default the controller type that is created is <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Kubernetes Deployments</a>,
which is meant for long running processes. But if you want to create a controller
type which is <a href="https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/">Kubernetes Job</a>,
you can do that using the flag <code class="highlighter-rouge">--controller</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kedge init <span class="nt">--name</span> myjob <span class="nt">--image</span> jobimage <span class="nt">--controller</span> Job
</code></pre></div></div>

<h2 id="kedge-build">Kedge Build</h2>

<p><strong>Build:</strong></p>

<p>Build container image with image name <code class="highlighter-rouge">username/myapp:version</code></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> kedge build <span class="nt">-i</span> username/myapp:version
</code></pre></div></div>

<p>Here you might wanna replace the <code class="highlighter-rouge">username</code> with container image registry URL and then
<code class="highlighter-rouge">username</code>.</p>

<p><strong>Build &amp; Push:</strong></p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> kedge build <span class="nt">-i</span> username/myapp:version <span class="nt">-p</span>
</code></pre></div></div>

<p>If you want to build image and also push it to the registry then use the flag <code class="highlighter-rouge">-p</code>.</p>

<p><strong>Note</strong>: You should have access to push image to that container registry. Read more about
<code class="highlighter-rouge">docker login</code> on official <a href="https://docs.docker.com/engine/reference/commandline/login/">docs</a>.</p>

<p><strong>Dockerfile and context are different:</strong></p>

<p>If you have a file structure like this, where your <code class="highlighter-rouge">Dockerfile</code> resides in a directory and
your code context is different.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> tree
<span class="c">.
</span><span class="go">├── main.go
├── parsego.go
├── scripts
│   ├── Dockerfile
│   ├── entrypoint.sh
│   └── k8s-release
</span><span class="c">...
</span></code></pre></div></div>

<p>To do builds in environment like above, run following command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> kedge build <span class="nt">-i</span> surajd/json-schema <span class="nt">-c</span> <span class="nb">.</span> <span class="nt">-f</span> scripts/Dockerfile 
<span class="go">INFO[0000] Building image 'surajd/json-schema' from directory 'json-schema-generator' 
INFO[0001] Image 'surajd/json-schema' from directory 'json-schema-generator' built successfully
</span></code></pre></div></div>

<p><strong>Build in minikube/minishift:</strong></p>

<p>If you are running Kubernetes in a environment like minikube or minishift run following
command before running this build command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">eval</span> <span class="k">$(</span>minikube docker-env<span class="k">)</span>
</code></pre></div></div>

<h3 id="build-using-source-to-image">Build using source to image</h3>

<p>You can hand off the image building work to OpenShift’s source to image utility, without having
to write any Dockerfile.</p>

<p>To do build using OpensShift’s s2i run following command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> kedge build <span class="nt">--s2i</span> <span class="nt">--image</span> pyappth <span class="nt">-b</span> centos/python-35-centos7:3.5
</code></pre></div></div>

<p>Deconstructing above command, we can see that to enable using OpenShift’s s2i use the boolean
flag <code class="highlighter-rouge">--s2i</code> then give the output name of the ImageStream that will be created using flag
<code class="highlighter-rouge">--image</code> and finally also provide what builder image to use to do builds of the code using
flag <code class="highlighter-rouge">-b</code>.</p>

<p><strong>Note</strong>: Flag <code class="highlighter-rouge">-b</code> is valid only when using s2i mode. And build flag <code class="highlighter-rouge">-p</code> is not valid when
in s2i mode.</p>


    </main>
  </div>
</body>

</html>
